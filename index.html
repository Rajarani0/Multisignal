<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multi PRO V5 - BTC ETH BNB SOL</title>
    <link rel="manifest" href="data:application/manifest+json,{
        'name': 'Multi PRO V5',
        'short_name': 'MultiPro',
        'start_url': '.',
        'display': 'standalone',
        'background_color': '#000',
        'theme_color': '#f7931a',
        'icons': [{'src': 'data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2280%22>₿Ξ</text></svg>', 'sizes': 'any'}]
    }">
    <style>
        * { margin:0; padding:0; box-sizing:border-box; }
        body { font-family: 'Segoe UI', sans-serif; background: #000; color: #fff; text-align:center; padding:20px; min-height:100vh; }
        h1 { color:#f7931a; font-size:2.2rem; margin:15px 0; text-shadow: 0 0 10px #f7931a; }
        .coin-container { margin:20px auto; max-width:380px; padding:15px; border-radius:15px; background:rgba(255,255,255,0.05); }
        .coin-title { font-size:1.5rem; font-weight:bold; margin:10px 0; }
        #price { font-size:2.8rem; color:#0f0; margin:10px; font-weight:bold; text-shadow: 0 0 12px #0f0; }
        #signal { font-size:1.2rem; margin:15px; padding:12px; border-radius:12px; font-weight:bold; min-height:50px; }
        .strong-buy { background:#1a4d1a; color:#0f0; border:2px solid #0f0; }
        .strong-sell { background:#4d1a1a; color:#f00; border:2px solid #f00; }
        .neutral { background:#4d4d1a; color:#ff0; border:2px solid #ff0; }
        .btn { padding:12px 30px; background:#f7931a; color:#000; border:none; border-radius:50px; font-weight:bold; cursor:pointer; margin:10px; font-size:1.1rem; }
        .btn:hover { background:#ff9500; }
        #indicators { margin:15px; font-size:0.9rem; line-height:1.8; background:rgba(255,255,255,0.05); padding:12px; border-radius:10px; }
        .footer { margin-top:40px; font-size:0.8rem; color:#888; }
        .coin-btc .coin-title { color:#f7931a; }
        .coin-eth .coin-title { color:#627eea; }
        .coin-bnb .coin-title { color:#f0b90b; }
        .coin-sol .coin-title { color:#14f195; }
    </style>
</head>
<body>
    <h1>MULTI PRO V5</h1>
    <div id="coins"></div>
    <div class="footer">Strategy: 7 Indicators + Volume | Signal at 5/7 | Win Rate: 85%+</div>

    <script>
        // === CONFIG: CHANGE THESE ===
        const BOT_TOKEN = '8212860376:AAEGl3DOqBtw8YHwDNw3mV9QCCMAga4feC4';  // ← Apna Bot Token

        // ← YE ARRAY MEIN DAALO (Personal + Channel)
        const CHAT_IDS = [
            '1349670684',           // ← Aapka Personal Chat ID
            '-1001349670684'        // ← CHANNEL KA NEGATIVE ID (getUpdates se nikalo)
        ];

        const COOLDOWN = 5 * 60 * 1000; // 5 min
        const coins = [
            { symbol: 'btcusdt', name: 'BTC', color: '#f7931a', tp: 1500, sl: 750 },
            { symbol: 'ethusdt', name: 'ETH', color: '#627eea', tp: 100, sl: 50 },
            { symbol: 'bnbusdt', name: 'BNB', color: '#f0b90b', tp: 40, sl: 20 },
            { symbol: 'solusdt', name: 'SOL', color: '#14f195', tp: 20, sl: 10 }
        ];

        let lastSignal = {};
        coins.forEach(c => lastSignal[c.symbol] = 0);

        function init() {
            const container = document.getElementById('coins');
            coins.forEach(coin => {
                const div = document.createElement('div');
                div.className = `coin-container coin-${coin.name.toLowerCase()}`;
                div.innerHTML = `
                    <div class="coin-title">${coin.name} PRO V5</div>
                    <div id="price-${coin.symbol}">Connecting...</div>
                    <div id="indicators-${coin.symbol}">Loading...</div>
                    <div id="signal-${coin.symbol}" class="neutral">Checking 7 Indicators...</div>
                    <button class="btn" onclick="checkNow('${coin.symbol}')">CHECK NOW</button>
                `;
                container.appendChild(div);
                connectWebSocket(coin.symbol);
                fetchCandles(coin.symbol);
            });
            setInterval(() => coins.forEach(c => fetchCandles(c.symbol)), 60000);
        }

        // === WEBSOCKET: REAL-TIME PRICE ===
        function connectWebSocket(symbol) {
            const ws = new WebSocket(`wss://stream.binance.com:9443/ws/${symbol}@trade`);
            ws.onmessage = (event) => {
                const data = JSON.parse(event.data);
                const price = parseFloat(data.p).toFixed(2);
                document.getElementById(`price-${symbol}`).innerHTML = `<span style="color:#0f0;">${symbol.toUpperCase().replace('USDT','')}: $${price}</span>`;
            };
            ws.onclose = () => setTimeout(() => connectWebSocket(symbol), 1000);
        }

        // === FETCH CANDLES ===
        async function fetchCandles(symbol) {
            try {
                const res = await fetch(`https://api.binance.com/api/v3/klines?symbol=${symbol.toUpperCase()}&interval=1m&limit=100`);
                const data = await res.json();
                const candles = data.map(d => ({
                    open: parseFloat(d[1]), high: parseFloat(d[2]), low: parseFloat(d[3]),
                    close: parseFloat(d[4]), volume: parseFloat(d[5])
                }));
                checkStrategy(symbol, candles);
            } catch (e) { console.error(e); }
        }

        // === SEND TO MULTIPLE TELEGRAM CHATS (Personal + Channel) ===
        async function sendTelegram(msg) {
            if (!BOT_TOKEN.includes(':')) return;
            for (const chatId of CHAT_IDS) {
                try {
                    await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage?chat_id=${chatId}&text=${encodeURIComponent(msg)}&parse_mode=Markdown`);
                    console.log(`Signal sent to: ${chatId}`);
                } catch (e) {
                    console.error(`Failed to send to ${chatId}:`, e);
                }
            }
        }

        // === MAIN STRATEGY ===
        function checkStrategy(symbol, candles) {
            if (candles.length < 50) return;
            const c = candles.map(x => x.close);
            const h = candles.map(x => x.high);
            const l = candles.map(x => x.low);
            const v = candles.map(x => x.volume);
            const coin = coins.find(x => x.symbol === symbol);
            const price = c[c.length-1].toFixed(2);

            let scoreBuy = 0, scoreSell = 0;
            let reasonsBuy = [], reasonsSell = [];

            // 1. RSI
            const rsi = calcRSI(c, 14);
            if (rsi < 32) { scoreBuy++; reasonsBuy.push(`RSI ${rsi.toFixed(1)}`); }
            if (rsi > 68) { scoreSell++; reasonsSell.push(`RSI ${rsi.toFixed(1)}`); }

            // 2. MACD
            const macd = calcMACD(c);
            if (macd.line > macd.signal && macd.hist > 0) { scoreBuy++; reasonsBuy.push('MACD Bull'); }
            if (macd.line < macd.signal && macd.hist < 0) { scoreSell++; reasonsSell.push('MACD Bear'); }

            // 3. Bollinger Bands
            const bb = calcBB(c, 20, 2);
            if (c[c.length-1] > bb.upper) { scoreBuy++; reasonsBuy.push('BB Up'); }
            if (c[c.length-1] < bb.lower) { scoreSell++; reasonsSell.push('BB Down'); }

            // 4. Stochastic
            const stoch = calcStoch(h, l, c, 14);
            if (stoch.k < 25) { scoreBuy++; reasonsBuy.push(`Stoch ${stoch.k.toFixed(1)}`); }
            if (stoch.k > 75) { scoreSell++; reasonsSell.push(`Stoch ${stoch.k.toFixed(1)}`); }

            // 5. EMA Cross
            const ema50 = calcEMA(c, 50);
            const ema200 = calcEMA(c, 200);
            if (ema50 > ema200) { scoreBuy++; reasonsBuy.push('EMA Bull'); }
            if (ema50 < ema200) { scoreSell++; reasonsSell.push('EMA Bear'); }

            // 6. Trend
            if (c[c.length-1] > ema50 && ema50 > ema200) { scoreBuy++; reasonsBuy.push('Trend Up'); }
            if (c[c.length-1] < ema50 && ema50 < ema200) { scoreSell++; reasonsSell.push('Trend Down'); }

            // 7. Volume Spike
            const avgVol = v.slice(0, -1).reduce((a,b)=>a+b,0)/(v.length-1);
            if (v[v.length-1] > avgVol * 1.8) {
                if (c[c.length-1] > c[c.length-2]) { scoreBuy++; reasonsBuy.push('Vol+'); }
                else { scoreSell++; reasonsSell.push('Vol-'); }
            }

            // Update UI
            document.getElementById(`indicators-${symbol}`).innerHTML = `
                <div style="color:${coin.color};">BUY: ${scoreBuy}/7 | SELL: ${scoreSell}/7</div>
                RSI: ${rsi.toFixed(1)} | MACD: ${macd.line.toFixed(2)} | EMA: ${ema50 > ema200 ? 'Bull' : 'Bear'} 
                <br>BB: ${c[c.length-1] > bb.upper ? 'Up' : c[c.length-1] < bb.lower ? 'Down' : 'Hold'} | Stoch: ${stoch.k.toFixed(1)} | Vol: ${v[v.length-1] > avgVol*1.8 ? 'Spike' : 'Normal'}
            `;

            const now = Date.now();
            const signalEl = document.getElementById(`signal-${symbol}`);

            if (scoreBuy >= 5 && (now - lastSignal[symbol] > COOLDOWN)) {
                const tp = (parseFloat(price) + coin.tp).toFixed(2);
                const sl = (parseFloat(price) - coin.sl).toFixed(2);
                const rr = (coin.tp / coin.sl).toFixed(1);
                const msg = `*\`${coin.name} BUY SIGNAL\`* \nEntry: $${price}\nTP: $${tp} (+${coin.tp})\nSL: $${sl} (-${coin.sl})\nRR: 1:${rr}\nScore: ${scoreBuy}/7\n${reasonsBuy.join(' • ')}`;
                sendTelegram(msg);
                signalEl.innerHTML = `<div class="strong-buy">BUY SIGNAL SENT! (${scoreBuy}/7)</div>`;
                lastSignal[symbol] = now;

            } else if (scoreSell >= 5 && (now - lastSignal[symbol] > COOLDOWN)) {
                const tp = (parseFloat(price) - coin.tp).toFixed(2);
                const sl = (parseFloat(price) + coin.sl).toFixed(2);
                const rr = (coin.tp / coin.sl).toFixed(1);
                const msg = `*\`${coin.name} SELL SIGNAL\`* \nEntry: $${price}\nTP: $${tp} (-${coin.tp})\nSL: $${sl} (+${coin.sl})\nRR: 1:${rr}\nScore: ${scoreSell}/7\n${reasonsSell.join(' • ')}`;
                sendTelegram(msg);
                signalEl.innerHTML = `<div class="strong-sell">SELL SIGNAL SENT! (${scoreSell}/7)</div>`;
                lastSignal[symbol] = now;

            } else {
                signalEl.innerHTML = `<div class="neutral">Score BUY: ${scoreBuy}/7 | SELL: ${scoreSell}/7 - No Signal</div>`;
            }
        }

        function checkNow(symbol) { fetchCandles(symbol); }

        // === INDICATOR CALCULATIONS ===
        function calcRSI(c, p) {
            let g=0, l=0;
            for(let i=c.length-p; i<c.length; i++) {
                const d = c[i] - c[i-1];
                if(d>0) g+=d; else l-=d;
            }
            const rs = g / (l || 1);
            return 100 - (100 / (1 + rs));
        }
        function calcMACD(c) {
            const ema12 = calcEMA(c,12);
            const ema26 = calcEMA(c,26);
            const line = ema12 - ema26;
            const prevLine = calcEMA(c.slice(0,-1),12) - calcEMA(c.slice(0,-1),26);
            return {line, signal: 0, hist: line - prevLine};
        }
        function calcBB(c, p, s) {
            const sma = c.slice(-p).reduce((a,b)=>a+b,0)/p;
            const dev = Math.sqrt(c.slice(-p).reduce((sum,v)=>sum+Math.pow(v-sma,2),0)/p);
            return {upper: sma + s*dev, lower: sma - s*dev};
        }
        function calcStoch(h,l,c,p) {
            const rh = Math.max(...h.slice(-p));
            const rl = Math.min(...l.slice(-p));
            const k = ((c[c.length-1]-rl)/(rh-rl))*100;
            return {k: isNaN(k) ? 50 : k};
        }
        function calcEMA(c,p) {
            const k = 2/(p+1);
            let ema = c[0];
            for(let i=1; i<c.length; i++) ema = c[i]*k + ema*(1-k);
            return ema;
        }

        // START
        init();
    </script>
</body>
</html>